
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Construindo Microservi√ßos Escal√°veis com Node.js e Docker - Jo√£o Dev</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar scrolled" id="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <span class="code-text">const</span> 
        <span class="highlight">Jo√£o</span>: 
        <span class="string">string</span> = 
        <span class="string-value">"üë®‚Äçüíª Software Engineer";</span>
      </div>
      <div class="nav-menu" id="nav-menu">
        <a href="index.html" class="nav-link">Home</a>
        <a href="blog.html" class="nav-link">Blog</a>
        <a href="index.html#about" class="nav-link">Sobre</a>
        <a href="index.html#projects" class="nav-link">Projetos</a>
        <a href="index.html#contact" class="nav-link">Contato</a>
      </div>
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Article Header -->
  <header class="article-header">
    <div class="container">
      <div class="article-breadcrumb">
        <a href="blog.html">
          <i class="fas fa-arrow-left"></i>
          Voltar para o Blog
        </a>
      </div>
      <div class="article-category">Backend</div>
      <h1 class="article-title">Construindo Microservi√ßos Escal√°veis com Node.js e Docker</h1>
      <p class="article-subtitle">
        Aprenda como desenvolver uma arquitetura de microservi√ßos robusta e escal√°vel usando Node.js, Docker e Kubernetes. Incluindo boas pr√°ticas de comunica√ß√£o entre servi√ßos.
      </p>
      <div class="article-meta">
        <div class="article-author">
          <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=50&h=50&fit=crop&crop=face" alt="Jo√£o" class="author-avatar">
          <div class="author-info">
            <span class="author-name">Jo√£o Dev</span>
            <span class="author-title">Software Engineer</span>
          </div>
        </div>
        <div class="article-details">
          <span class="article-date">
            <i class="fas fa-calendar"></i>
            15 de Janeiro, 2024
          </span>
          <span class="article-reading-time">
            <i class="fas fa-clock"></i>
            8 min de leitura
          </span>
        </div>
      </div>
      <div class="article-tags">
        <span class="article-tag">Node.js</span>
        <span class="article-tag">Docker</span>
        <span class="article-tag">Kubernetes</span>
        <span class="article-tag">Microservi√ßos</span>
      </div>
    </div>
  </header>

  <!-- Article Content -->
  <article class="article-content">
    <div class="container">
      <div class="article-body">
        <img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=1200&h=600&fit=crop" alt="Microservi√ßos com Node.js" class="article-featured-image">
        
        <div class="article-text">
          <h2>Introdu√ß√£o aos Microservi√ßos</h2>
          <p>
            Os microservi√ßos representam uma abordagem arquitetural que estrutura uma aplica√ß√£o como uma cole√ß√£o de servi√ßos fracamente acoplados. 
            Essa arquitetura oferece benef√≠cios significativos em termos de escalabilidade, manutenibilidade e flexibilidade tecnol√≥gica.
          </p>

          <p>
            Neste artigo, vamos explorar como construir uma arquitetura de microservi√ßos robusta usando Node.js e Docker, 
            cobrindo desde os conceitos fundamentais at√© a implementa√ß√£o pr√°tica.
          </p>

          <h2>Por que Escolher Node.js para Microservi√ßos?</h2>
          <p>
            Node.js se destaca como uma escolha excelente para microservi√ßos por v√°rias raz√µes:
          </p>

          <ul>
            <li><strong>Performance:</strong> Event-driven e non-blocking I/O proporcionam alta performance</li>
            <li><strong>Escalabilidade:</strong> Ideal para aplica√ß√µes I/O intensivas</li>
            <li><strong>Ecossistema:</strong> NPM oferece um vasto ecossistema de packages</li>
            <li><strong>Produtividade:</strong> JavaScript tanto no frontend quanto no backend</li>
          </ul>

          <h2>Estrutura B√°sica de um Microservi√ßo</h2>
          <p>Vamos come√ßar criando um microservi√ßo simples para gerenciamento de usu√°rios:</p>

          <pre><code class="language-javascript">
// user-service/app.js
const express = require('express');
const cors = require('cors');
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');

const app = express();
const PORT = process.env.PORT || 3001;

// Middlewares de seguran√ßa
app.use(helmet());
app.use(cors());
app.use(express.json({ limit: '10mb' }));

// Rate limiting
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100 // limit each IP to 100 requests per windowMs
});
app.use(limiter);

// Routes
app.get('/users', async (req, res) => {
  // L√≥gica para buscar usu√°rios
  res.json({ message: 'Lista de usu√°rios' });
});

app.post('/users', async (req, res) => {
  // L√≥gica para criar usu√°rio
  res.json({ message: 'Usu√°rio criado com sucesso' });
});

app.listen(PORT, () => {
  console.log(`User Service rodando na porta ${PORT}`);
});
          </code></pre>

          <h2>Containeriza√ß√£o com Docker</h2>
          <p>
            Docker √© fundamental para garantir consist√™ncia entre diferentes ambientes. 
            Aqui est√° um Dockerfile otimizado para aplica√ß√µes Node.js:
          </p>

          <pre><code class="language-dockerfile">
# user-service/Dockerfile
FROM node:18-alpine

WORKDIR /app

# Instalar depend√™ncias primeiro (cache layer)
COPY package*.json ./
RUN npm ci --only=production

# Copiar c√≥digo da aplica√ß√£o
COPY . .

# Criar usu√°rio n√£o-root
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodejs -u 1001
USER nodejs

EXPOSE 3001

CMD ["node", "app.js"]
          </code></pre>

          <h2>Comunica√ß√£o Entre Servi√ßos</h2>
          <p>
            A comunica√ß√£o entre microservi√ßos pode ser feita de v√°rias formas. Vamos explorar as principais abordagens:
          </p>

          <h3>1. HTTP/REST APIs</h3>
          <p>Comunica√ß√£o s√≠ncrona simples e amplamente suportada:</p>

          <pre><code class="language-javascript">
// order-service/services/userService.js
const axios = require('axios');

class UserService {
  constructor() {
    this.baseURL = process.env.USER_SERVICE_URL || 'http://localhost:3001';
  }

  async getUserById(userId) {
    try {
      const response = await axios.get(`${this.baseURL}/users/${userId}`);
      return response.data;
    } catch (error) {
      throw new Error(`Erro ao buscar usu√°rio: ${error.message}`);
    }
  }
}

module.exports = new UserService();
          </code></pre>

          <h3>2. Message Queues (RabbitMQ)</h3>
          <p>Para comunica√ß√£o ass√≠ncrona e desacoplamento:</p>

          <pre><code class="language-javascript">
// utils/messageQueue.js
const amqp = require('amqplib');

class MessageQueue {
  async connect() {
    this.connection = await amqp.connect(process.env.RABBITMQ_URL);
    this.channel = await this.connection.createChannel();
  }

  async publishEvent(queue, event) {
    await this.channel.assertQueue(queue, { durable: true });
    await this.channel.sendToQueue(queue, Buffer.from(JSON.stringify(event)));
  }

  async subscribeToEvents(queue, callback) {
    await this.channel.assertQueue(queue, { durable: true });
    await this.channel.consume(queue, callback, { noAck: false });
  }
}

module.exports = new MessageQueue();
          </code></pre>

          <h2>Docker Compose para Desenvolvimento</h2>
          <p>
            Para facilitar o desenvolvimento local com m√∫ltiplos servi√ßos, utilizamos Docker Compose:
          </p>

          <pre><code class="language-yaml">
# docker-compose.yml
version: '3.8'

services:
  user-service:
    build: ./user-service
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=development
      - DB_HOST=postgres
      - RABBITMQ_URL=amqp://rabbitmq:5672
    depends_on:
      - postgres
      - rabbitmq

  order-service:
    build: ./order-service
    ports:
      - "3002:3002"
    environment:
      - NODE_ENV=development
      - USER_SERVICE_URL=http://user-service:3001
      - DB_HOST=postgres
    depends_on:
      - postgres
      - user-service

  postgres:
    image: postgres:14-alpine
    environment:
      POSTGRES_DB: microservices
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data

  rabbitmq:
    image: rabbitmq:3-management-alpine
    ports:
      - "5672:5672"
      - "15672:15672"

volumes:
  postgres_data:
          </code></pre>

          <h2>Monitoramento e Observabilidade</h2>
          <p>
            Para uma arquitetura de microservi√ßos em produ√ß√£o, √© essencial implementar monitoramento adequado:
          </p>

          <pre><code class="language-javascript">
// middleware/monitoring.js
const prometheus = require('prom-client');

// M√©tricas customizadas
const httpRequestsTotal = new prometheus.Counter({
  name: 'http_requests_total',
  help: 'Total number of HTTP requests',
  labelNames: ['method', 'route', 'status_code']
});

const httpRequestDuration = new prometheus.Histogram({
  name: 'http_request_duration_seconds',
  help: 'Duration of HTTP requests in seconds',
  labelNames: ['method', 'route']
});

module.exports = {
  requestMetrics: (req, res, next) => {
    const start = Date.now();
    
    res.on('finish', () => {
      const duration = (Date.now() - start) / 1000;
      
      httpRequestsTotal.labels(req.method, req.route?.path || req.url, res.statusCode).inc();
      httpRequestDuration.labels(req.method, req.route?.path || req.url).observe(duration);
    });
    
    next();
  },
  register: prometheus.register
};
          </code></pre>

          <h2>Boas Pr√°ticas para Produ√ß√£o</h2>
          <p>Algumas recomenda√ß√µes importantes para ambientes de produ√ß√£o:</p>

          <ul>
            <li><strong>Health Checks:</strong> Implemente endpoints de sa√∫de para monitoramento</li>
            <li><strong>Circuit Breakers:</strong> Use bibliotecas como Hystrix para evitar falhas em cascata</li>
            <li><strong>Logging Estruturado:</strong> Utilize formata√ß√£o JSON para logs centralizados</li>
            <li><strong>Versionamento de APIs:</strong> Mantenha backward compatibility</li>
            <li><strong>Testes:</strong> Implemente testes unit√°rios, de integra√ß√£o e contratos</li>
          </ul>

          <h2>Conclus√£o</h2>
          <p>
            A arquitetura de microservi√ßos com Node.js e Docker oferece uma base s√≥lida para aplica√ß√µes escal√°veis e mant√≠veis. 
            O sucesso depende da implementa√ß√£o cuidadosa de padr√µes de comunica√ß√£o, monitoramento e pr√°ticas de desenvolvimento.
          </p>

          <p>
            No pr√≥ximo artigo, exploraremos como implementar padr√µes avan√ßados como API Gateway, 
            Service Discovery e estrat√©gias de deploy com zero downtime.
          </p>
        </div>
      </div>

      <!-- Share and Navigation -->
      <div class="article-footer">
        <div class="article-share">
          <h4>Compartilhe este artigo:</h4>
          <div class="share-buttons">
            <a href="#" class="share-btn twitter" title="Compartilhar no Twitter">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="#" class="share-btn linkedin" title="Compartilhar no LinkedIn">
              <i class="fab fa-linkedin"></i>
            </a>
            <a href="#" class="share-btn facebook" title="Compartilhar no Facebook">
              <i class="fab fa-facebook"></i>
            </a>
          </div>
        </div>
        
        <div class="article-navigation">
          <a href="blog.html" class="nav-btn">
            <i class="fas fa-arrow-left"></i>
            <span>Voltar ao Blog</span>
          </a>
          <a href="artigo-react-performance.html" class="nav-btn next">
            <span>Pr√≥ximo Artigo</span>
            <i class="fas fa-arrow-right"></i>
          </a>
        </div>
      </div>
    </div>
  </article>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-left">
          <p>&copy; 2024 Jo√£o Dev. Todos os direitos reservados.</p>
        </div>
        <div class="footer-right">
          <p>Feito com <i class="fas fa-heart"></i> usando tecnologias modernas</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
</body>
</html>
